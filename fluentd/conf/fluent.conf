# Step 1: ãƒ­ã‚°ã®å…¥åŠ›è¨­å®š
<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Step 2: OpenSearchã¸ã®å‡ºåŠ›è¨­å®š
<match **>
  @type opensearch
  host opensearch
  port 9200
  scheme http
  
  # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åã®è¨­å®š (kubernetes-YYYYMMDD å½¢å¼ã«å¤‰æ›´)
  logstash_format true
  logstash_prefix kubernetes
  include_tag_key true

  # ãƒ­ã‚°ã®ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°è¨­å®š
  <buffer tag, time>
    @type file
    path /fluentd/log/opensearch_buffer
    timekey 1d              # ğŸ‘ˆ ã“ã®è¡Œã‚’è¿½åŠ : 1æ—¥ã”ã¨ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
    timekey_wait 10m        # ğŸ‘ˆ ã“ã®è¡Œã‚’è¿½åŠ : 10åˆ†ã®å¾…æ©Ÿæ™‚é–“
    flush_interval 5s
    retry_max_interval 30
    retry_max_times 5
  </buffer>
</match>
